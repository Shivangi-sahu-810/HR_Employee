SELECT D.D_NAME AS DEPARTMENT_NAME, COUNT(E.EMPNO) AS TOTAL_EMPLOYEES
FROM EMP E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
GROUP BY D.D_NAME;



SELECT D.D_NAME AS DEPARTMENT_NAME, ROUND(AVG(E.SALARY), 2) AS AVG_SALARY
FROM EMP E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
GROUP BY D.D_NAME;



SELECT TO_CHAR(LAST_WORKING_DATE, 'YYYY') AS YEAR, COUNT(*) AS RESIGNATIONS
FROM ATTRITION
GROUP BY TO_CHAR(LAST_WORKING_DATE, 'YYYY');


SELECT E.ENAME, D.D_NAME AS DEPARTMENT, A.LAST_WORKING_DATE, A.ATTRITION_REASON
FROM EMP E
JOIN ATTRITION A ON E.EMPNO = A.EMPNO
JOIN DEPT D ON E.DEPTNO = D.DEPTNO;



SELECT STATUS, COUNT(*) AS TOTAL
FROM EMP
GROUP BY STATUS;


SELECT EMPNO, ENAME, DOJ
FROM EMP
WHERE DOJ < TO_DATE('2020-01-01', 'YYYY-MM-DD');


SELECT D.D_NAME AS DEPARTMENT, MAX(E.SALARY) AS MAX_SALARY
FROM EMP E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
GROUP BY D.D_NAME;


SELECT D.D_NAME AS DEPARTMENT, COUNT(A.EMPNO) AS RESIGNATION_COUNT
FROM ATTRITION A
JOIN EMP E ON A.EMPNO = E.EMPNO
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
GROUP BY D.D_NAME
ORDER BY RESIGNATION_COUNT DESC;
